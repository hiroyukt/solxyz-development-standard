# 3. コメント

- [3. コメント](#3-コメント)
  - [3.1. クラスのJavadocコメントを書くようにしてください](#31-クラスのjavadocコメントを書くようにしてください)
  - [3.2. フィールドのJavadocコメントを書くようにしてください](#32-フィールドのjavadocコメントを書くようにしてください)
  - [3.3. メソッドのJavadocコメントを書くようにしてください](#33-メソッドのjavadocコメントを書くようにしてください)
  - [3.4. コードの理解を助けるため、必要に応じて行コメントを記載してください](#34-コードの理解を助けるため必要に応じて行コメントを記載してください)
  - [3.5. 過度な装飾は不要です](#35-過度な装飾は不要です)

コードを見ればどのように実装されているかが理解できます。

設計書を見れば実行結果がどのようになっていなければならないかが理解できます。

しかし、なぜその実装になっているのかは実装者の脳内にしかない場合があります。

そのような場合に他の人に伝える手段はコードコメントしかありません。

特に実装手法になぜ他の手段を選ばなかったのかは、基本的にコードコメントにしか残りません。

重要なコメントは残すようにしてください。

本章はJavadocコメントや処理の説明をするためのコメントに関する規約です。

コメントは自分自身、一緒に仕事をしている人、後に関わる開発者へソースコードを理解しやすい形にするものです。

明確で正しくシンプルなコメントを書くことを心がけてください。

## 3.1. クラスのJavadocコメントを書くようにしてください

クラスのJavadocコメントには、そのクラスの役割を記載してください。

プロジェクトのルールに応じて`@author`や`@since`なども記載してください。

```java
/**
 * 商品情報を表すクラスです。
 * 
 * @author Tanaka
 */
public class Item {
```

## 3.2. フィールドのJavadocコメントを書くようにしてください

フィールドのJavadocコメントには、それがどのような属性を表すものなのか、記載してください。

```java
/**
 * 商品コード
 */
private String code;

/**
 * 商品の名称
 */
private String name;

/**
 * 更新日時
 */
private LocalDateTime updatedAt;
```

## 3.3. メソッドのJavadocコメントを書くようにしてください

メソッドのJavadocには、そのメソッドが行う処理の概要を記載してください。
また、そのメソッドを呼び出す上で前提条件があれば、それも記載してください。

`@param`で引数の説明を、`@return`で戻り値の説明を、`@throws`でスローされる可能性がある例外の説明を記載してください。

`@throws`では例外クラスの日本語名だけを書いて済ませてはいけません。
該当の例外がスローされるのはどのような場合かを記載してください。

```java
//Bad 例外クラスの名前を記載しているだけなのでNG。
 ...
 * @throws ItemNotFoundException 商品Not Found例外
 */
```

```java
//Good 例外がスローされるのはどのような場合か記載している。
 ...
 * @throws ItemNotFoundException 更新対象の商品がデータベース内に見つからない場合
 */
```

次に示す引数と戻り値における`null`の扱いは、アプリケーション全体のデフォルトがどちらなのかをプロジェクトで決めてください。

- 引数に`null`を許可する、もしくは許可しない
- 戻り値として`null`を返される場合がある、もしくは必ず`null`でない値が返る

そしてデフォルトから外れる場合のみ、その旨をJavadocへ記載するようにしてください。

たとえば、「デフォルトでは引数に`null`を許可しない」とルールを決めた場合、`null`を受け取れる引数には`null`を受け取るとどのように振舞うのかを記載してください。

nullを受け取らない場合、`@NonNull`アノテーションをつけることがあります。

この場合、`null`を受け取らないことがコード上で理解できるため、Javadocへの記載を必須とはしません。

```java
/**
 * 商品情報を更新します。
 *
 * <p>
 * このメソッドではすで登録済みの商品に対して更新を行います。
 * まだ商品を登録していない場合は、先に登録処理を行ってください。
 * </p>
 *
 * @param code 商品コード
 * @param name 商品の名称
 * @param updatedAt 更新日時。nullの場合はデフォルト値としてシステム日時が使用される
 * @throws ItemNotFoundException 更新対象の商品がデータベース内に見つからない場合
 */
public void updateItem(final String code, final String name, final LocalDateTime updatedAt)
        throws ItemNotFoundException {
    ...
}
```

## 3.4. コードの理解を助けるため、必要に応じて行コメントを記載してください

コードだけを読んで処理の内容を理解できるのが理想的ですが、複雑なロジックや、パフォーマンスのためにあえて特殊な実装をした場合は説明のコメントを記載してください。
コメントは`//`から始まる一行コメントの形式で記載してください。

たとえば次のコードは1000円以上の注文について5%引きされていることが理解できます。

しかしなぜそのようなルールになっているかということは理解できません。

メソッド分割をし、どういったルールなのかをメソッド名につけることが可読性の向上に繋がるため強く推奨します。

```java
if (grandTotal >= 1000.00) {
    grandTotal = grandTotal * 0.95;
}
```

## 3.5. 過度な装飾は不要です

アスタリスク`*`でコメントを囲った箱などは、コードに変更が加わった際に崩れるなど、ちょっとした価値に比べれば大きな時間の無駄です。そのようなコメントを書かなければ注意が引けないコードではなく、メソッドやクラスを分けた単一責任の原則に基づくきれいなコードを書くように心がけてください。さらに、コードを表示するディスプレイや印刷するプリントに使われるフォントはプロポーショナルだったりそうでなかったりして、箱をきれいに整列させることは困難です。

Javadocで表現できないほど煩雑で複雑な場合、設計がJavaで正しく表現できているかを確認してください。

単純なCOBOLコンバートの場合、煩雑になりがちです。

1行コメントは`//`、複数行コメントは`/* */`、Javadocは`/** */`です。

それ以外の装飾は不要です。

```java
//Bad 過度な装飾が施されたコメントになっている
/**
 * ◯○画面アクション
 */
public void actionA() {
    ...
    //*****************************
    //*                           *
    //* A処理                      *
    //* この処理では〜〜〜〜〜 　　　　*
    //*                           *
    //*****************************
    ...
    //*****************************
    //*                           *
    //* B処理                      *
    //* A処理を行なった後のDB登録を〜 *
    //*                           *
    //*****************************
    ...
    
}
```

```java
//Good Javadocに内容が書かれている
/**
 * ◯○画面アクション
 */
public void actionA() {
    ...
    // 入力チェック
    runA(str);
    // DB登録
    runB();
}

/**
 * A処理
 * 入力チェックを行う
 * @param str 入力値
 * @throws NullPointerException 入力値がnullの場合
 */
private void runA(final String str) {
    /*
    ~~~~~
    */
    ... 
}

/**
 * B処理
 */
private void runB() {
    ... 
}
```

